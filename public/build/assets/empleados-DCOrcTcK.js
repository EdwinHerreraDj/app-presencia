import{g as f}from"./gridjs.umd-V6YQZSHU.js";import"./_commonjsHelpers-BosuxZz1.js";document.addEventListener("DOMContentLoaded",function(){const m=document.getElementById("password"),n=document.getElementById("password_confirmation"),p=document.createElement("div"),I=document.querySelectorAll("#email, #EmpleadoEmailEdit");let o=document.createElement("div");o.textContent="El email ya está en uso",o.classList.add("text-danger","mt-1","hidden");function h(){n.value!==m.value?(p.textContent="Las contraseñas no coinciden",n.classList.add("is-invalid"),m.classList.add("is-invalid")):(p.textContent="",n.classList.remove("is-invalid"),m.classList.remove("is-invalid"))}n.addEventListener("input",h);function y(a){const e=a.value.trim();e?fetch(`/check-email?email=${encodeURIComponent(e)}`).then(t=>t.json()).then(t=>{t.exists?(o.classList.remove("hidden"),a.parentElement.appendChild(o),a.classList.add("is-invalid")):(o.remove(),a.classList.remove("is-invalid"))}).catch(t=>{console.error("Error en la verificación del email:",t)}):(o.classList.add("hidden"),a.classList.remove("is-invalid"))}if(I.forEach(a=>{a.addEventListener("blur",function(){y(this)})}),typeof window.empleadosData<"u"){const a=window.empleadosData.map(e=>[e.nombre,e.telefono,e.DNI,e.email,e.deshabilitado?"Sí":"No",e.geolocalizacion_estricta?"Sí":"No",e.id]);new f.Grid({columns:["Nombre","Teléfono","DNI","Email","Deshabilitado","Geo estricta",{name:"Acciones",formatter:(e,t)=>{const d=t.cells[6].data,c=t.cells[0].data,E=t.cells[1].data,u=t.cells[2].data,v=t.cells[3].data,l=t.cells[4].data,i=t.cells[5].data;return f.html(`
                <div style="text-align: right;">
                    <button type="button" class="btn btn-sm btn-primary mb-2"
                        data-bs-toggle="modal"
                        data-bs-target="#editEmpleadoModal"
                        data-id="${d}"
                        data-nombre="${c}"
                        data-telefono="${E}"
                        data-dni="${u}"
                        data-email="${v}"
                        data-deshabilitado="${l}"
                        data-geo="${i}">
                        Editar
                    </button>
                    <a data-empleado-id-delete="${d}" class="btn btn-sm btn-danger modal-eliminar mb-2" 
                        data-bs-toggle="modal" data-bs-target="#modalEliminarEmpleado">
                        Eliminar
                    </a>
                </div>
            `)}}],data:a,search:!0,pagination:{enabled:!0,limit:5},sort:!0}).render(document.getElementById("table-empleados"))}else console.error("No se encontraron datos de empleados.");const b=document.getElementById("errorPassEdit"),r=document.getElementById("EmpleadoPasswordEdit"),s=document.getElementById("EmpleadoPasswordConfirmEdit");function L(){r.value!==s.value?(b.textContent="Las contraseñas no coinciden",r.classList.add("is-invalid"),s.classList.add("is-invalid")):(b.textContent="",r.classList.remove("is-invalid"),s.classList.remove("is-invalid"))}s.addEventListener("input",L);var B=document.getElementById("editEmpleadoModal");B.addEventListener("show.bs.modal",function(a){var e=a.relatedTarget,t=document.getElementById("editEmpleadoForm"),d=e.getAttribute("data-id"),c=e.getAttribute("data-nombre"),E=e.getAttribute("data-telefono"),u=e.getAttribute("data-dni"),v=e.getAttribute("data-email"),l=e.getAttribute("data-deshabilitado");l=l==="Sí"?1:0;var i=e.getAttribute("data-geo");i=i==="Sí"?1:0,t.action=`/empleados/update/${d}`,document.getElementById("EmpleadoIdEdit").value=d,document.getElementById("EmpleadoNombreEdit").value=c,document.getElementById("EmpleadoTelefonoEdit").value=E,document.getElementById("EmpleadoDNIEdit").value=u,document.getElementById("EmpleadoEmailEdit").value=v,document.getElementById("EmpleadoDeshabilitadoEdit").value=l,document.getElementById("EmpleadoGeoEdit").value=i});var g=document.getElementById("modalEliminarEmpleado");g.addEventListener("show.bs.modal",function(a){var e=a.relatedTarget,t=e.getAttribute("data-empleado-id-delete"),d=g.querySelector(".formularioEliminar");d.querySelector(".user_id").value=t,d.action=`/empleados/delete/${t}`})});
