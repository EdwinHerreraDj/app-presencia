import{g as I}from"./gridjs.umd-V6YQZSHU.js";import"./_commonjsHelpers-BosuxZz1.js";document.addEventListener("DOMContentLoaded",function(){const l=document.getElementById("password"),i=document.getElementById("password_confirmation"),f=document.getElementById("passwordConfirmationError"),L=document.getElementById("userForm"),m=document.getElementById("email"),g=document.getElementById("emailError");i.addEventListener("blur",b),L.addEventListener("submit",function(t){b()||t.preventDefault()});function b(){return i.value!==l.value?(l.classList.add("is-invalid"),i.classList.add("is-invalid"),f.textContent="Las contrase침as no coinciden",!1):(l.classList.remove("is-invalid"),i.classList.remove("is-invalid"),f.textContent="",!0)}if(m.addEventListener("blur",function(){const t=this.value.trim();t&&fetch(`/check-email?email=${encodeURIComponent(t)}`).then(e=>e.json()).then(e=>{e.exists?(g.textContent="El email ya est치 en uso",m.classList.add("is-invalid")):(g.textContent="",m.classList.remove("is-invalid"))}).catch(e=>{console.error("Error en la verificaci칩n del email:",e)})}),typeof window.usersData<"u"){const t=window.usersData.map(e=>[e.name,e.email,e.rol,e.id]);new I.Grid({columns:["Nombre","Email","Rol",{name:"Acciones",formatter:(e,a)=>{const r=a.cells[3].data,u=a.cells[0].data,c=a.cells[1].data,v=a.cells[2].data;return I.html(`
                            <div style="text-align: right;">
                                <button type="button" class="btn btn-sm btn-primary mb-2" 
                                    data-bs-toggle="modal" 
                                    data-bs-target="#editModal"
                                    data-user-id="${r}"
                                    data-user-name="${u}"
                                    data-user-email="${c}"
                                    data-user-rol="${v}">
                                    Editar
                                </button>
                                <a data-user-id-delete="${r}" class="btn btn-sm btn-danger modal-eliminar mb-2" data-bs-toggle="modal"
                                data-bs-target="#modalEliminar">Eliminar</a>
                            </div>
                    `)}}],data:t,search:!0,pagination:{enabled:!0,limit:5},sort:!0}).render(document.getElementById("table-gridjs"))}else console.error("No se encontraron datos de usuarios.");var n=document.getElementById("editModal");n.addEventListener("show.bs.modal",function(t){var e=t.relatedTarget,d=document.getElementById("editForm"),a=e.getAttribute("data-user-id"),r=e.getAttribute("data-user-name"),u=e.getAttribute("data-user-email"),c=e.getAttribute("data-user-rol");d.action=`/users/${a}`,document.getElementById("modalUserId").value=a,document.getElementById("modalUserName").value=r,document.getElementById("modalUserEmail").value=u,document.getElementById("modalUserRol").value=c;var v=n.querySelector(".modal-title");v.textContent="Editar Usuario: "+r;const o=n.querySelector("#password_edit"),s=n.querySelector("#password_confirmation_edit"),E=n.querySelector("#passwordConfirmationErrorEdit");function p(){return o.value===""&&s.value===""?(s.classList.remove("is-invalid"),E.textContent="",!0):o.value!==s.value?(o.classList.add("is-invalid"),s.classList.add("is-invalid"),E.textContent="Las contrase침as no coinciden",!1):(o.classList.remove("is-invalid"),s.classList.remove("is-invalid"),E.textContent="",!0)}s.addEventListener("blur",p);var d=n.querySelector("form");d&&d.addEventListener("submit",function(w){p()||w.preventDefault()})});var y=document.getElementById("modalEliminar");y.addEventListener("show.bs.modal",function(t){var e=t.relatedTarget,a=e.getAttribute("data-user-id-delete"),r=y.querySelector(".formularioEliminar");r.querySelector(".user_id").value=a,r.action=`/users/delete/${a}`})});
